<html>
<head>
	<meta http-equiv="Content-Script-Type" content="text/javascript">
</head>
<body>

<!--ここをPOSTで送るようにする。-->

<script>
var req = new XMLHttpRequest();

// ハンドラの登録.
req.onreadystatechange = function() {
    switch ( req.readyState ) {
        case 0:
            // 未初期化状態.
            console.log( 'uninitialized!' );
            break;
        case 1: // データ送信中.
            console.log( 'loading...' );
            break;
        case 2: // 応答待ち.
            console.log( 'loaded.' );
            break;
        case 3: // データ受信中.
            console.log('interactive... '+req.responseText.length+' bytes.' );
            break;
        case 4: // データ受信完了.
            if( req.status == 200 || req.status == 304 ) {
				var jsonString = req.responseText; // responseXML もあり
				//var jsonString = '[{"id":"24"},{"id":"23"},{"id":"22"},{"id":"21"},{"id":"20"},{"id":"19"},{"id":"18"},{"id":"17"},{"id":"16"},{"id":"15"},{"id":"14"},{"id":"13"},{"id":"12"},{"id":"10"},{"id":"9"},{"id":"8"},{"id":"7"},{"id":"6"},{"id":"5"},{"id":"4"}]';
				var jsonObject = JSON.parse(jsonString);
				console.log(jsonObject);
				document.getElementById("tweet").value = "<table>";

				for(var i = 0; i < jsonObject.length; i++){
					console.log(jsonObject[i]['id']);
				}
				document.getElementById("tweet").value = "</table>";
            } else {
                console.log( 'Failed. HttpStatus: '+req.statusText );
            }
            break;
		}
	}

//ツイート内容を送信
function execPost() {
	var param = "tweet_text=seinoyorokobi";
	req.open('POST', '../php/tweet_post.php', true);
	// POST 送信の場合は Content-Type は固定.
	req.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded' );
	req.send(param);
}
function getTweet(){
	req.open('POST', '../php/tweet_get.php', true);
	req.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded' );
	req.send(null);
}


</script>
<a onClick="getTweet()">getTweet</a>
<a onClick="execPost()">POST送信</a>
	<form action="tweetManager.php" method="post">
	    <input type="hidden" name="mode" value="tweet_regist">
	    <table>
	        <caption>ツイート登録フォーム</caption>
	        <tr>
	            <td class="item">ツイート内容：</td>
	            <td><input type="text" name="tweet_text" size="40"></td>
	        </tr>
	    </table>
	    <div><input type="submit" name="submit" value="送信"></div>
	</form>

	<form action="tweetManager.php" method="post">
	    <input type="hidden" name="mode" value="user_search">
	    <table>
	        <caption>ユーザー検索</caption>
	        <tr>
	            <td class="item">ユーザー名</td>
	            <td><input type="text" name="user_id" size="40"></td>
	        </tr>
	    </table>
	    <div><input type="submit" name="submit" value="送信"></div>
	</form>
	<div>ツイート一覧</div>
	<div id="tweet">some text here</div>

 </body>
</html>
